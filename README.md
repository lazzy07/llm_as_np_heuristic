
# Narrative Plan Analyzer using LLM and Sabre Heuristic Data

This project utilizes the Sabre Heuristic Data Generator and Sabre Benchmarks to analyze narrative plans with the assistance of a Large Language Model (LLM) via the ChatGPT API. The project aims to gather information about incomplete narrative plans, including plan length and next best actions, using both syntactical and natural language prompts.

## Project Overview

### Tools Used

- **[Sabre Heuristic Data Generator](https://github.com/sgware/sabre-heuristic-data-generator)**: 
  This tool uses the Sabre Narrative Planner to perform an exhaustive explanation-first search of a benchmark problem. It generates a CSV file with information about all the search nodes discovered that are either solutions or ancestors of solutions. This data is used to evaluate Sabre's search heuristics and aid in developing new heuristic techniques.

- **[Sabre Benchmarks](https://github.com/sgware/sabre-benchmarks)**:
  A collection of benchmark story planning problems used for evaluating narrative planner Sabre.
### LLM Integration

This project leverages an LLM (via the ChatGPT API) to analyze narrative plans, focusing on:

1. **Incomplete Narrative Plans**: Obtaining incomplete plans from the Sabre Benchmarks.
2. **LLM Suggestions**: Using the LLM to predict the next best action based on incomplete plans.
3. **Plan Length Evaluation**: Assessing the length of the generated plans and comparing them with the Sabre heuristics.

### Key Features

- **Prompt Generation**: 
  Prompts used to query the LLM are stored in the `out_prompts_and_results` folder. There are different versions of prompts:
    - **Syntx**: Focusing on the structure and rules of the narrative problem.
    - **Natural**: Focusing on intuitive, human-like descriptions.
  
- **LLM Output**: 
  All LLM responses, including plan suggestions, are saved in the `output_llm_new` folder in CSV format for further analysis.

- **Benchmark Data**: 
  Data from the Sabre Heuristic Data Generator is stored in the `data_new` folder for comparison with the LLM-generated plans.

## Usage

### Command-Line Arguments

- `--maxlength`: Specifies the maximum length for the plan. For example, `--maxlength=10` limits the plan length to 10.
- `--problem`: Selects the problem to solve from the `problems` folder. For example, `--problem=gramma` chooses the "gramma" problem.
- `--nodes`: Defines the number of nodes to sample from the narrative planner. For example, `--nodes=1000`.
- `--seed`: Sets the random seed used for node sampling. For example, `--seed=100`.
- `--execute`: Specifies the type of prompts to use when querying the LLM. Available options are:
    - `prompts`: Generate prompts only, the program won't query LLM.
    - `syntax`: Use syntactical prompts only when queriying the LLM.
    - `natural`: Use natural language prompts only when queriying the LLM.
    - `both`: Use both syntactical and natural language prompts when queriying the LLM.

### Example

```bash
java -jar dist/narrative-analyzer.jar --maxlength=10 --problem=gramma --nodes=1000 --seed=100 --execute=prompts
```

This command will:
- Set a maximum plan length of 10.
- Use the "gramma" problem from the problem set.
- Sample 1000 nodes from the planner using seed 100.
- Use prompts to query the LLM for a complete plan.

## Folder Structure

- `out_prompts_and_results/`: Contains all the LLM prompts and corresponding results.
- `output_llm_new/`: CSV files with detailed results from the LLM, including plan length and action predictions.
- `data_new/`: Contains data generated by the Sabre Heuristic Data Generator.
